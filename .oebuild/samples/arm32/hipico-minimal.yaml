build_in: docker
machine: hipico
toolchain_type: EXTERNAL_TOOLCHAIN:arm
cache_src_dir:
no_layer: false
repos:
- yocto-poky
- yocto-meta-openembedded
local_conf: |+
  EXTERNAL_TOOLCHAIN_LLVM = "/usr1/openeuler/llvm-musl-arm"
  DISTRO_FEATURES:append = " clang ld-is-lld"
  DISTRO_FEATURES_NATIVE:append = " clang "
  EXTERNAL_TOOLCHAIN_CLANG_BIN = "${EXTERNAL_TOOLCHAIN_LLVM}/bin"
  EXTERNAL_TOOLCHAIN_GCC:arm = "/usr1/openeuler/gcc/openeuler_gcc_arm32le-musl"
  EXTERNAL_TARGET_SYS:arm = "arm-openeuler-linux-musleabi"
  TCLIBC = "musl"
  TCMODE-LIBC = "musl"
  TCMODE-CRYPT = "musl"
  MACHINE_ESSENTIAL_EXTRA_RDEPENDS = "musl"

  DISTRO_FEATURES:append = " mini-img"

layers:
- yocto-meta-openeuler/bsp/meta-hisilicon
- yocto-meta-openembedded/meta-multimedia
- yocto-meta-openeuler/meta-clang
- yocto-meta-openeuler/meta-musl
docker_param:
  image: swr.cn-north-4.myhuaweicloud.com/openeuler-embedded/openeuler-container:latest
  parameters: -itd --network host
  volumns:
  - /dev/net/tun:/dev/net/tun
  command: bash
bitbake_cmds:
- bitbake openeuler-image-minimal
